<!DOCTYPE html>
<!-- saved from url=(0098)https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/ -->
<html lang="en"><script type="text/javascript" async="" src="./How to process textual data using TF-IDF in Python_files/analytics.js.download"></script><script async="" src="./How to process textual data using TF-IDF in Python_files/gtm.js.download"></script><script>(function main() {
    // Create enabled event
    function fireEnabledEvent() {
        // If gli exists, then we are already present and shouldn't do anything
        if (!window.gli) {
            setTimeout(function () {
                var enabledEvent = document.createEvent("Event");
                enabledEvent.initEvent("WebGLEnabledEvent", true, true);
                document.dispatchEvent(enabledEvent);
            }, 0);
        } else {
            //console.log("WebGL Inspector already embedded on the page - disabling extension");
        }
    };

    // Grab the path root from the extension
    document.addEventListener("WebGLInspectorReadyEvent", function (e) {
        var pathElement = document.getElementById("__webglpathroot");
        if (window["gliloader"]) {
            gliloader.pathRoot = pathElement.innerText;
        } else {
            // TODO: more?
            window.gliCssUrl = pathElement.innerText + "gli.all.css";
        }
    }, false);

    // Rewrite getContext to snoop for webgl
    var originalGetContext = HTMLCanvasElement.prototype.getContext;
    if (!HTMLCanvasElement.prototype.getContextRaw) {
        HTMLCanvasElement.prototype.getContextRaw = originalGetContext;
    }
    HTMLCanvasElement.prototype.getContext = function () {
        var ignoreCanvas = this.internalInspectorSurface;
        if (ignoreCanvas) {
            return originalGetContext.apply(this, arguments);
        }

        var result = originalGetContext.apply(this, arguments);
        if (result == null) {
            return null;
        }

        var contextNames = ["moz-webgl", "webkit-3d", "experimental-webgl", "webgl", "3d"];
        var requestingWebGL = contextNames.indexOf(arguments[0]) != -1;
        if (requestingWebGL) {
            // Page is requesting a WebGL context!
            fireEnabledEvent(this);

            // If we are injected, inspect this context
            if (window.gli) {
                if (gli.host.inspectContext) {
                    // TODO: pull options from extension
                    result = gli.host.inspectContext(this, result);
                    // NOTE: execute in a timeout so that if the dom is not yet
                    // loaded this won't error out.
                    window.setTimeout(function() {
                        var hostUI = new gli.host.HostUI(result);
                        result.hostUI = hostUI; // just so we can access it later for debugging
                    }, 0);
                }
            }
        }

        return result;
    };
})();</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>How to process textual data using TF-IDF in Python</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="./How to process textual data using TF-IDF in Python_files/prism.min.css">
    <link rel="stylesheet" type="text/css" href="./How to process textual data using TF-IDF in Python_files/prism-unescaped-markup.css">

    <link href="./How to process textual data using TF-IDF in Python_files/css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./How to process textual data using TF-IDF in Python_files/screen.css">
    <link rel="stylesheet" type="text/css" href="./How to process textual data using TF-IDF in Python_files/algolia-search.css">
    
    <script src="./How to process textual data using TF-IDF in Python_files/algoliasearch.min.js.download"></script>
    <script src="./How to process textual data using TF-IDF in Python_files/autocomplete.min.js.download"></script>

    <script src="./How to process textual data using TF-IDF in Python_files/saved_resource"></script>

    <link rel="shortcut icon" href="https://www.freecodecamp.org/news/favicon.png" type="image/png">
    <link rel="canonical" href="https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/amp/">
    
    <meta property="og:site_name" content="freeCodeCamp.org">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How to process textual data using TF-IDF in Python">
    <meta property="og:description" content="by Mayank Tripathi

Computers are good with numbers, but not that much with textual data. One of the
most widely used techniques to process textual data is TF-IDF. In this article,
we will learn how it works and what are its features.

From our intuition, we think that the words which appear more often should have
a greater weight in textual data analysis, but that’s not always the case. Words
such as “the”, “will”, and “you” — called stopwords  — appear the most in a
corpus of text, but are of ">
    <meta property="og:url" content="https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/">
    <meta property="og:image" content="https://cdn-media-1.freecodecamp.org/images/1*JTk6iVMiZCQCr8duiaKlHQ.png">
    <meta property="article:published_time" content="2018-06-06T16:07:18.000Z">
    <meta property="article:modified_time" content="2019-07-24T00:06:01.000Z">
    <meta property="article:tag" content="Data Science">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Tech">
    <meta property="article:tag" content="Programming">
    <meta property="article:tag" content="Technology">
    
    <meta property="article:publisher" content="https://www.facebook.com/freecodecamp">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="How to process textual data using TF-IDF in Python">
    <meta name="twitter:description" content="by Mayank Tripathi

Computers are good with numbers, but not that much with textual data. One of the
most widely used techniques to process textual data is TF-IDF. In this article,
we will learn how it works and what are its features.

From our intuition, we think that the words which appear more often should have
a greater weight in textual data analysis, but that’s not always the case. Words
such as “the”, “will”, and “you” — called stopwords  — appear the most in a
corpus of text, but are of ">
    <meta name="twitter:url" content="https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/">
    <meta name="twitter:image" content="https://cdn-media-1.freecodecamp.org/images/1*JTk6iVMiZCQCr8duiaKlHQ.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="freeCodeCamp.org">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Data Science, Python, Tech, Programming, Technology">
    <meta name="twitter:site" content="@freecodecamp">
    <meta property="og:image:width" content="800">
    <meta property="og:image:height" content="445">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "freeCodeCamp.org",
        "logo": "https://www.freecodecamp.org/news/content/images/2019/10/minified.svg"
    },
    "author": {
        "@type": "Person",
        "name": "freeCodeCamp.org",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/fcda43852608626fe46d7fd43145766e?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://www.freecodecamp.org/news/author/freecodecamp/",
        "sameAs": []
    },
    "headline": "How to process textual data using TF-IDF in Python",
    "url": "https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/",
    "datePublished": "2018-06-06T16:07:18.000Z",
    "dateModified": "2019-07-24T00:06:01.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://cdn-media-1.freecodecamp.org/images/1*JTk6iVMiZCQCr8duiaKlHQ.png",
        "width": 800,
        "height": 445
    },
    "keywords": "Data Science, Python, Tech, Programming, Technology",
    "description": "by Mayank Tripathi\n\nComputers are good with numbers, but not that much with textual data. One of the\nmost widely used techniques to process textual data is TF-IDF. In this article,\nwe will learn how it works and what are its features.\n\nFrom our intuition, we think that the words which appear more often should have\na greater weight in textual data analysis, but that’s not always the case. Words\nsuch as “the”, “will”, and “you” — called stopwords  — appear the most in a\ncorpus of text, but are of ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.freecodecamp.org/news/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.25">
    <link rel="alternate" type="application/rss+xml" title="freeCodeCamp.org" href="https://www.freecodecamp.org/news/rss/">
    <script>
  // Set up dataLayer with data if provided
  window.dataLayer = window.dataLayer || [{ gaPropertyId: 'UA-55446531-20' }];

  // Initialized GTM via gtag
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-55446531-20');

  // Configure and initialize GTM
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl+'&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer', 'GTM-5D6RKKP');
</script>

<script>
// For Runkit embeds
document.addEventListener('DOMContentLoaded', function() {
  (function() {
    const runkitElements = document.querySelectorAll('.runkit-element');
	  runkitElements.forEach(function(element) {
      const source = element.innerHTML.replace(/&amp;/g, '&');
      element.innerHTML = '';
      RunKit.createNotebook({element, source});
	  });
  })();
});
</script>

<style id="fit-vids-style">.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style></head>

<body class="post-template tag-data-science tag-python tag-tech tag-programming tag-technology">

    <div class="site-wrapper">
        <nav class="site-nav nav-padding">
    <div class="site-nav-left">
        <form onsubmit="event.preventDefault();">
  <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;"><input type="search" placeholder="Search 5,000+ tutorials" id="search-input" class="aa-input" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top;"><pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: Lato, sans-serif; font-size: 18px; font-style: normal; font-variant: normal; font-weight: 400; word-spacing: 0px; letter-spacing: normal; text-indent: 0px; text-rendering: auto; text-transform: none;"></pre><span class="aa-dropdown-menu" role="listbox" id="algolia-autocomplete-listbox-0" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: auto;"><div class="aa-dataset-1"></div></span></span>
</form>

<script>
  const client = algoliasearch('QMJYL5WYTI', '4318af87aa3ce128708f1153556c6108');
  const index = client.initIndex('news');
  autocomplete('#search-input', { hint: false }, [
    {
      source: autocomplete.sources.hits(index, { hitsPerPage: 8 }),
      debounce: 250,
      templates: {
        suggestion: (suggestion, result) => {
          return `
            <a href="${suggestion.url}">
              <div class="algolia-result">
                <span>${suggestion._highlightResult.title.value}</span>
              </div>
            </a>
          `;
        },
        empty: (options) => {
          return `
            <div class="algolia-result">
              No tutorials found
            </div>
          `;
        },
        footer: (query, result) => {
          if (!query.isEmpty) {
            return `
              <hr/>
              <a href="https://freecodecamp.org/news/search?query=${result.query}">
                <div class="algolia-result algolia-footer">
                  <span>See all results for ${result.query}</span>
                </div>
              </a>
            `;
          }
        }
      }
    }
  ]).on('autocomplete:selected', (event, suggestion, dataset, context) => {
    // Set to true if hit is selected by mouse or enter key
    hitSelected = true;
    // Do nothing on click, as the browser will already do it
    if (context.selectionMethod === 'click') {
      return;
    }
    // Change the page, for example, on other events
    window.location.assign(suggestion.url);
  });

  // If no hits in the Autocomplete dropdown are highlighted,
  // treat input like normal search bar
  const input = document.getElementById("search-input");
  let searchQuery;
  let hitSelected;

  // Get the value of the search bar after each key event
  input.addEventListener('input', e => {
    searchQuery = input.value;
  });

  input.addEventListener('keydown', e => {
    if (event.key === "Enter" && !hitSelected && searchQuery) {
      window.location.assign(`https://freecodecamp.org/news/search?query=${searchQuery}`);
    }
  });
</script>    </div>
    <div class="site-nav-middle">
        <a class="site-nav-logo" href="https://www.freecodecamp.org/news"><img src="./How to process textual data using TF-IDF in Python_files/minified.svg" alt="freeCodeCamp.org"></a>
    </div>
    <div class="site-nav-right main-nav">
        <div class="main-nav-group">
            <ul class="nav" role="menu">
    <li class="nav-news" role="menuitem"><a href="https://www.freecodecamp.org/news/">/news</a></li>
    <li class="nav-forum" role="menuitem"><a href="https://www.freecodecamp.org/forum/">/forum</a></li>
    <li class="nav-learn" role="menuitem"><a href="https://www.freecodecamp.org/learn/">/learn</a></li>
</ul>

        </div>
    </div>
    <button class="site-nav-right toggle-button-nav">
        Menu
    </button>
</nav>


        




<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-data-science tag-python tag-tech tag-programming tag-technology ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2018-06-06">6 June 2018</time>
                    <span class="date-divider">/</span>
                    <a href="https://www.freecodecamp.org/news/tag/data-science/">
                        #Data Science
                    </a>
                </section>
                <h1 class="post-full-title">How to process textual data using TF-IDF in Python</h1>
            </header>

            <div class="post-full-author-header">


            </div>

            <figure class="post-full-image">
                <img srcset="https://cdn-media-1.freecodecamp.org/images/1*JTk6iVMiZCQCr8duiaKlHQ.png 300w,
                            https://cdn-media-1.freecodecamp.org/images/1*JTk6iVMiZCQCr8duiaKlHQ.png 600w,
                            https://cdn-media-1.freecodecamp.org/images/1*JTk6iVMiZCQCr8duiaKlHQ.png 1000w,
                            https://cdn-media-1.freecodecamp.org/images/1*JTk6iVMiZCQCr8duiaKlHQ.png 2000w" sizes="(max-width: 800px) 400px,
                            (max-width: 1170px) 700px,
                            1400px" src="./How to process textual data using TF-IDF in Python_files/1_JTk6iVMiZCQCr8duiaKlHQ.png" alt="How to process textual data using TF-IDF in Python" onerror="this.style.display=&#39;none&#39;">
            </figure>

            <section class=" post-full-content">
                <div class="post-content medium-migrated-article">
                    <p>by Mayank Tripathi</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_JTk6iVMiZCQCr8duiaKlHQ.png" class="kg-image"></figure><!--kg-card-end: image--><p>Computers are good with numbers, but not that much with textual data. One of the most widely used techniques to process textual data is TF-IDF. In this article, we will learn how it works and what are its features.</p><p>From our intuition, we think that the words which appear more often should have a greater weight in textual data analysis, but that’s not always the case. Words such as “the”, “will”, and “you” — called <strong>stopwords</strong> — appear the most in a corpus of text, but are of very little significance. Instead, the words which are rare are the ones that actually help in distinguishing between the data, and carry more weight.</p><h3 id="an-introduction-to-tf-idf">An introduction to TF-IDF</h3><p><strong>TF-IDF</strong> stands for “Term Frequency — Inverse Data Frequency”. First, we will learn what this term means mathematically.</p><p><strong>Term Frequency (tf)</strong>: gives us the frequency of the word in each document in the corpus. It is the ratio of number of times the word appears in a document compared to the total number of words in that document. It increases as the number of occurrences of that word within the document increases. Each document has its own tf.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_HM0Vcdrx2RApOyjp_ZeW_Q.png" class="kg-image"></figure><!--kg-card-end: image--><p><strong>Inverse Data Frequency (idf): </strong>used to calculate the weight of rare words across all documents in the corpus. The words that occur rarely in the corpus have a high IDF score. It is given by the equation below.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_A5YGwFpcTd0YTCdgoiHFUw.png" class="kg-image"></figure><!--kg-card-end: image--><p>Combining these two we come up with the TF-IDF score (w) for a word in a document in the corpus. It is the product of tf and idf:</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_nSqHXwOIJ2fa_EFLTh5KYw.png" class="kg-image"></figure><!--kg-card-end: image--><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_q2tRgjV_J-MLvnhwNAl0KQ.png" class="kg-image"></figure><!--kg-card-end: image--><p>Let’s take an example to get a clearer understanding.</p><p>Sentence 1 : The car is driven on the road.</p><p>Sentence 2: The truck is driven on the highway.</p><p>In this example, each sentence is a separate document.</p><p>We will now calculate the TF-IDF for the above two documents, which represent our corpus.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_q3qYevXqQOjJf6Pwdlx8Mw.png" class="kg-image"></figure><!--kg-card-end: image--><p>From the above table, we can see that TF-IDF of common words was zero, which shows they are not significant. On the other hand, the TF-IDF of “car” , “truck”, “road”, and “highway” are non-zero. These words have more significance.</p><h3 id="using-python-to-calculate-tf-idf">Using Python to calculate TF-IDF</h3><p>Lets now code TF-IDF in Python from scratch. After that, we will see how we can use sklearn to automate the process.</p><p>The function <code>computeTF</code> computes the TF score for each word in the corpus, by document.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_AgBLM-NRFEpWVhXM7I3XjQ.png" class="kg-image"></figure><!--kg-card-end: image--><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_RE_h1NoBqyW24oGU3tthew.png" class="kg-image"></figure><!--kg-card-end: image--><p>The function <code>computeIDF</code> computes the IDF score of every word in the corpus.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_EjHweFHuNa-rznvdPQaRbQ.png" class="kg-image"></figure><!--kg-card-end: image--><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_cGGCFDVZRdh4yVWKdUKj1g.png" class="kg-image"></figure><!--kg-card-end: image--><p>The function <code>computeTFIDF</code> below computes the TF-IDF score for each word, by multiplying the TF and IDF scores.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_QSTMOhLvIEcRtrEBzwrfPA.png" class="kg-image"></figure><!--kg-card-end: image--><p>The output produced by the above code for the set of documents D1 and D2 is the same as what we manually calculated above in the table.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_aLUwNr58mazdfs7DHT1Z6Q.png" class="kg-image"></figure><!--kg-card-end: image--><p>You can refer to <a href="https://github.com/mayank408/TFIDF" rel="noopener">this link</a> for the complete implementation.</p><h4 id="sklearn">sklearn</h4><p>Now we will see how we can implement this using sklearn in Python.</p><p>First, we will import <code>TfidfVectorizer</code> from <code>sklearn.feature_extraction.text</code>:</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_w9tnnHtsjZwyuFhve5uM1g.png" class="kg-image"></figure><!--kg-card-end: image--><p>Now we will initialise the <code>vectorizer</code> and then call fit and transform over it to calculate the TF-IDF score for the text.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_H0_K3rA-tK3hP8KUdq3o8A.png" class="kg-image"></figure><!--kg-card-end: image--><p>Under the hood, the sklearn fit_transform executes the following <code>fit </code>and <code>transform</code> functions. These can be found in the official sklearn library at GitHub.</p><!--kg-card-begin: code--><pre class=" language-py"><code class=" language-py">
    <span class="token keyword">def</span> <span class="token function">fit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Learn the idf vector (global term weights)
        Parameters
        ----------
        X : sparse matrix, [n_samples, n_features]
            a matrix of term/token counts
        """</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> sp<span class="token punctuation">.</span>issparse<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>
            X <span class="token operator">=</span> sp<span class="token punctuation">.</span>csc_matrix<span class="token punctuation">(</span>X<span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>use_idf<span class="token punctuation">:</span>
            n_samples<span class="token punctuation">,</span> n_features <span class="token operator">=</span> X<span class="token punctuation">.</span>shape
            df <span class="token operator">=</span> _document_frequency<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

            <span class="token comment"># perform idf smoothing if required</span>
            df <span class="token operator">+=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>smooth_idf<span class="token punctuation">)</span>
            n_samples <span class="token operator">+=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>smooth_idf<span class="token punctuation">)</span>

            <span class="token comment"># log+1 instead of log makes sure terms with zero idf don't get</span>
            <span class="token comment"># suppressed entirely.</span>
            idf <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>n_samples<span class="token punctuation">)</span> <span class="token operator">/</span> df<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1.0</span>
            self<span class="token punctuation">.</span>_idf_diag <span class="token operator">=</span> sp<span class="token punctuation">.</span>spdiags<span class="token punctuation">(</span>idf<span class="token punctuation">,</span> diags<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> m<span class="token operator">=</span>n_features<span class="token punctuation">,</span>
                                        n<span class="token operator">=</span>n_features<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'csr'</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">transform</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> X<span class="token punctuation">,</span> copy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""Transform a count matrix to a tf or tf-idf representation
        Parameters
        ----------
        X : sparse matrix, [n_samples, n_features]
            a matrix of term/token counts
        copy : boolean, default True
            Whether to copy X and operate on the copy or perform in-place
            operations.
        Returns
        -------
        vectors : sparse matrix, [n_samples, n_features]
        """</span>
        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token string">'dtype'</span><span class="token punctuation">)</span> <span class="token keyword">and</span> np<span class="token punctuation">.</span>issubdtype<span class="token punctuation">(</span>X<span class="token punctuation">.</span>dtype<span class="token punctuation">,</span> np<span class="token punctuation">.</span>floating<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># preserve float family dtype</span>
            X <span class="token operator">=</span> sp<span class="token punctuation">.</span>csr_matrix<span class="token punctuation">(</span>X<span class="token punctuation">,</span> copy<span class="token operator">=</span>copy<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># convert counts or binary occurrences to floats</span>
            X <span class="token operator">=</span> sp<span class="token punctuation">.</span>csr_matrix<span class="token punctuation">(</span>X<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float64<span class="token punctuation">,</span> copy<span class="token operator">=</span>copy<span class="token punctuation">)</span>

        n_samples<span class="token punctuation">,</span> n_features <span class="token operator">=</span> X<span class="token punctuation">.</span>shape

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>sublinear_tf<span class="token punctuation">:</span>
            np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>X<span class="token punctuation">.</span>data<span class="token punctuation">,</span> X<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
            X<span class="token punctuation">.</span>data <span class="token operator">+=</span> <span class="token number">1</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>use_idf<span class="token punctuation">:</span>
            check_is_fitted<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'_idf_diag'</span><span class="token punctuation">,</span> <span class="token string">'idf vector is not fitted'</span><span class="token punctuation">)</span>

            expected_n_features <span class="token operator">=</span> self<span class="token punctuation">.</span>_idf_diag<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> n_features <span class="token operator">!=</span> expected_n_features<span class="token punctuation">:</span>
                <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Input has n_features=%d while the model"</span>
                                 <span class="token string">" has been trained with n_features=%d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>
                                     n_features<span class="token punctuation">,</span> expected_n_features<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment"># *= doesn't work</span>
            X <span class="token operator">=</span> X <span class="token operator">*</span> self<span class="token punctuation">.</span>_idf_diag

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>norm<span class="token punctuation">:</span>
            X <span class="token operator">=</span> normalize<span class="token punctuation">(</span>X<span class="token punctuation">,</span> norm<span class="token operator">=</span>self<span class="token punctuation">.</span>norm<span class="token punctuation">,</span> copy<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> X</code></pre><!--kg-card-end: code--><p>One thing to notice in the above code is that, instead of just the log of n_samples, 1 has been added to n_samples to calculate the IDF score. This ensures that the words with an IDF score of zero don’t get suppressed entirely.</p><p>The output obtained is in the form of a skewed matrix, which is normalised to get the following result.</p><!--kg-card-begin: image--><figure class="kg-card kg-image-card"><img src="./How to process textual data using TF-IDF in Python_files/1_d_Pk4czfcod_vFlFugWysA.png" class="kg-image"></figure><!--kg-card-end: image--><p>Thus we saw how we can easily code TF-IDF in just 4 lines using sklearn. Now we understand how powerful TF-IDF is as a tool to process textual data out of a corpus. To learn more about sklearn TF-IDF, you can use <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" rel="noopener">this link</a>.</p><p><strong>Happy coding!</strong></p><p>Thanks for reading this article. Be sure to share it if you find it helpful.</p><p>For more about programming, you can follow me, so that you get notified every time I come up with a new post.</p><p>Cheers!</p><p>Also, Let’s get connected on <a href="https://twitter.com/mayank_408" rel="noopener"><strong>Twitter</strong></a>, <a href="https://www.linkedin.com/in/mayank-tripathi-a49563126/" rel="noopener"><strong>Linkedin</strong></a>, <a href="https://github.com/mayank408" rel="noopener"><strong>Github</strong></a> and <a href="https://www.facebook.com/profile.php?id=100001106266064" rel="noopener"><strong>Facebook</strong></a>.</p>
                </div>
                <hr>
                <p>
    If this article was helpful,

    <a onclick="window.open(`https://twitter.com/share?text=How%20to%20process%20textual%20data%20using%20TF-IDF%20in%20Python&amp;url=https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/`, &#39;share-twitter&#39;, &#39;width=550,height=235&#39;);return false;">
        tweet it</a>
    or
    <a onclick="window.open(`https://www.facebook.com/sharer/sharer.php?u=https://www.freecodecamp.org/news/how-to-process-textual-data-using-tf-idf-in-python-cd2bbc0a94a3/`, &#39;share-facebook&#39;,&#39;width=580,height=296&#39;);return false;">
        share it</a>.
</p>                <p>
    <a href="https://freecodecamp.org/donate">
        Donate $5 and buy the world 250 hours of learning</a>.
</p>            </section>



        </article>
    </div>
</main>





<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            <article class="read-next-card" style="background-image: url(/news/content/images/size/w600/2019/06/background.png)">
                <header class="read-next-card-header">
                    <p class="read-next-card-header-sitetitle">Countinue reading about</p>
                    <h3 class="read-next-card-header-title"><a href="https://www.freecodecamp.org/news/tag/data-science/">Data Science</a></h3>
                </header>
                <div class="read-next-card-content">
                    <ul>
                        <li><a href="https://www.freecodecamp.org/news/adapting-your-developer-relations-strategy-for-data-science-and-ai-products/">How to adapt your developer relations strategy for data science and AI products</a></li>
                        <li><a href="https://www.freecodecamp.org/news/optimize-your-jupyter-notebook/">How to optimize your Jupyter Notebook</a></li>
                        <li><a href="https://www.freecodecamp.org/news/powerful-tools-for-elasticsearch-data-visualization-analysis/">Powerful tools for Elasticsearch data visualization &amp; analysis</a></li>
                    </ul>
                </div>
                <footer class="read-next-card-footer">
                    <a href="https://www.freecodecamp.org/news/tag/data-science/">See all 277 posts
                        →</a>
                </footer>
            </article>

            <article class="post-card post tag-programming tag-philosophy tag-algorithms tag-computer-science tag-technology ">

    <a class="post-card-image-link" href="https://www.freecodecamp.org/news/the-philosophy-of-programming-e901bd37363a/">
        <img class="post-card-image" srcset="https://cdn-media-1.freecodecamp.org/images/0*GskYn20OaaZ4T3u6. 300w,
                    https://cdn-media-1.freecodecamp.org/images/0*GskYn20OaaZ4T3u6. 600w,
                    https://cdn-media-1.freecodecamp.org/images/0*GskYn20OaaZ4T3u6. 1000w,
                    https://cdn-media-1.freecodecamp.org/images/0*GskYn20OaaZ4T3u6. 2000w" sizes="(max-width: 1000px) 400px, 700px" onerror="this.style.display=&#39;none&#39;" src="./How to process textual data using TF-IDF in Python_files/0_GskYn20OaaZ4T3u6_" alt="The philosophy of programming">
    </a>

    <div class="post-card-content">

        <div class="post-card-content-link">

            <header class="post-card-header">
                <span class="post-card-tags">
                    <a href="https://www.freecodecamp.org/news/tag/programming/">
                        #Programming
                    </a>
                </span>
                <h2 class="post-card-title">
                    <a href="https://www.freecodecamp.org/news/the-philosophy-of-programming-e901bd37363a/">
                        The philosophy of programming
                    </a>
                </h2>
            </header>

        </div>


        <footer class="post-card-meta">

            <time class="meta-item-single">a year ago</time>


        </footer>

    </div>

</article>
            <article class="post-card post tag-ocr tag-opencv tag-tesseract tag-python tag-technology ">

    <a class="post-card-image-link" href="https://www.freecodecamp.org/news/getting-started-with-tesseract-part-ii-f7f9a0899b3f/">
        <img class="post-card-image" srcset="https://cdn-media-1.freecodecamp.org/images/1*iZwvUAtgcOAVgjO23Hd2ig.jpeg 300w,
                    https://cdn-media-1.freecodecamp.org/images/1*iZwvUAtgcOAVgjO23Hd2ig.jpeg 600w,
                    https://cdn-media-1.freecodecamp.org/images/1*iZwvUAtgcOAVgjO23Hd2ig.jpeg 1000w,
                    https://cdn-media-1.freecodecamp.org/images/1*iZwvUAtgcOAVgjO23Hd2ig.jpeg 2000w" sizes="(max-width: 1000px) 400px, 700px" onerror="this.style.display=&#39;none&#39;" src="./How to process textual data using TF-IDF in Python_files/1_iZwvUAtgcOAVgjO23Hd2ig.jpeg" alt="How to use image preprocessing to improve the accuracy of Tesseract">
    </a>

    <div class="post-card-content">

        <div class="post-card-content-link">

            <header class="post-card-header">
                <span class="post-card-tags">
                    <a href="https://www.freecodecamp.org/news/tag/ocr/">
                        #Ocr
                    </a>
                </span>
                <h2 class="post-card-title">
                    <a href="https://www.freecodecamp.org/news/getting-started-with-tesseract-part-ii-f7f9a0899b3f/">
                        How to use image preprocessing to improve the accuracy of Tesseract
                    </a>
                </h2>
            </header>

        </div>


        <footer class="post-card-meta">

            <time class="meta-item-single">a year ago</time>


        </footer>

    </div>

</article>
        </div>
    </div>
</aside>




        <footer class="site-footer">
    <div class="footer-container">
        <div class="footer-row">
            <div class="footer-desc-col">
                <p>freeCodeCamp is a donor-supported tax-exempt 501(c)(3) nonprofit organization (United States Federal
                    Tax Identification Number: 82-0779546)
                </p>
                <p>
                    Our mission: to help people learn to code for free. We accomplish this by creating thousands of
                    videos, articles, and interactive coding lessons - all freely available to the public. We also have
                    thousands of freeCodeCamp study groups around the world.
                </p>
                <p>
                    Donations to freeCodeCamp go toward our education initiatives, and help pay for servers, services,
                    and staff.
                </p>
                <p class="footer-donation">
                    You can&nbsp;<a href="https://freecodecamp.org/donate" class="inline" rel="noopener noreferrer" target="_blank">make a tax-deductible donation here</a>.
                </p>
            </div>
            <div class="footer-col-1 our-nonprofit">
                <div class="col-header">Our Nonprofit</div>
                <a href="https://www.freecodecamp.org/news/about/">About</a>
                <a href="https://www.linkedin.com/school/free-code-camp/people/" rel="noopener noreferrer" target="_blank">Alumni Network</a>
                <a href="https://github.com/freeCodeCamp/">Open Source</a>
                <a href="https://www.freecodecamp.org/shop/" rel="noopener noreferrer" target="_blank">Shop</a>
                <a href="https://www.freecodecamp.org/news/support/">Support</a>
                <a href="https://www.freecodecamp.org/news/sponsors/">Sponsors</a>
                <a href="https://www.freecodecamp.org/news/academic-honesty-policy/">Academic Honesty</a>
                <a href="https://www.freecodecamp.org/news/code-of-conduct/">Code of Conduct</a>
                <a href="https://www.freecodecamp.org/news/privacy-policy/">Privacy Policy</a>
                <a href="https://www.freecodecamp.org/news/terms-of-service/">Terms of Service</a>
                <a href="https://www.freecodecamp.org/news/copyright-policy/">Copyright Policy</a>
            </div>
            <div class="footer-col-2 trending-guides">
                <div class="col-header">Trending Guides</div>
                <a href="https://www.freecodecamp.org/news/2019-web-developer-roadmap/">2019 Web Developer Roadmap</a>
                <a href="https://www.freecodecamp.org/news/best-python-tutorial/">Python Tutorial</a>
                <a href="https://www.freecodecamp.org/news/understanding-flexbox-everything-you-need-to-know-b4013d4dc9af/">CSS
                    Flexbox Guide</a>
                <a href="https://www.freecodecamp.org/news/best-javascript-tutorial/">JavaScript Tutorial</a>
                <a href="https://www.freecodecamp.org/news/python-example/">Python Example </a>
                <a href="https://www.freecodecamp.org/news/best-html-html5-tutorial/">HTML Tutorial</a>
                <a href="https://www.freecodecamp.org/news/linux-command-line-bash-tutorial/">Linux Command Line
                    Guide</a>
                <a href="https://www.freecodecamp.org/news/javascript-example/">JavaScript Example</a>
                <a href="https://www.freecodecamp.org/news/best-git-tutorial/">Git Tutorial</a>
                <a href="https://www.freecodecamp.org/news/best-react-javascript-tutorial/">React Tutorial</a>
                <a href="https://www.freecodecamp.org/news/best-java-8-tutorial/">Java Tutorial</a>

            </div>
            <div class="footer-col-3">
                <div class="col-spacer"></div>
                <a href="https://www.freecodecamp.org/news/the-best-linux-tutorials/">Linux Tutorial</a>
                <a href="https://www.freecodecamp.org/news/best-css-and-css3-tutorial/">CSS Tutorial</a>
                <a href="https://www.freecodecamp.org/news/the-best-jquery-examples/">jQuery Example</a>
                <a href="https://www.freecodecamp.org/news/best-sql-database-tutorial/">SQL Tutorial</a>
                <a href="https://www.freecodecamp.org/news/css-example-css3/">CSS Example</a>
                <a href="https://www.freecodecamp.org/news/react-examples-reactjs/">React Example</a>
                <a href="https://www.freecodecamp.org/news/best-angular-tutorial-angularjs/">Angular Tutorial</a>
                <a href="https://www.freecodecamp.org/news/the-best-bootstrap-examples/">Bootstrap Example</a>
                <a href="https://www.freecodecamp.org/news/the-ultimate-guide-to-ssh-setting-up-ssh-keys/">How to Set Up
                    SSH Keys</a>
                <a href="https://www.freecodecamp.org/news/best-wordpress-tutorial/">WordPress Tutorial</a>
                <a href="https://www.freecodecamp.org/news/the-best-php-examples/">PHP Example</a>

            </div>
        </div>
    </div>
</footer>
    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script src="./How to process textual data using TF-IDF in Python_files/jquery-3.2.1.min.js.download" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
        </script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/jquery.fitvids.js.download"></script>

    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-unescaped-markup.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-markup-templating.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-bash.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-c.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-clojure.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-cpp.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-csharp.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-css.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-docker.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-elixir.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-erlang.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-git.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-go.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-graphql.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-haskell.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-java.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-javascript.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-json.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-jsx.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-kotlin.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-lua.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-markup.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-php.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-python.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-r.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-ruby.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-rust.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-scala.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-sql.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-swift.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-typescript.min.js.download"></script>
    <script type="text/javascript" src="./How to process textual data using TF-IDF in Python_files/prism-yaml.min.js.download"></script>

    <script>
    $(document).ready(function () {
        // Start fitVids
        var $postContent = $(".post-full-content");
        $postContent.fitVids();
        // End fitVids
    });
</script>

<script>
    $(document).ready(function () {
        $(".toggle-button-nav").click(function () {
            $(".nav").toggleClass("show-main-nav-items");
            $(".site-nav").toggleClass("expand-nav");
            $(".toggle-button-nav").toggleClass("reverse-toggle-color");
            $(".site-nav-left").toggleClass("display-search");
        });
    });
</script>


    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5D6RKKP"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



</body></html>